<!DOCTYPE html>
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="0">
<span style="color: #FF2400">â¬¨</span>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>LETH Dashboard</title>
        <script src="https://cdn.tailwindcss.com"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/5.7.2/ethers.umd.min.js"></script>
        <script src="price-data.js"></script>
        <script src="config.js"></script>
        <link rel="stylesheet" href="styles.css">
        <meta http-equiv="Content-Security-Policy" content="default-src * 'unsafe-inline' 'unsafe-eval' data: blob:; frame-src *; child-src *; worker-src *; frame-ancestors *;">
        <script type="text/javascript">
            function googleTranslateElementInit() {
                new google.translate.TranslateElement({
                    pageLanguage: 'en',
                    includedLanguages: 'pt,es,fr,ro,pl,ru,zh-CN,ja,ko,ar,hi,bn,id,ms,tr',
                    layout: google.translate.TranslateElement.InlineLayout.SIMPLE,
                    autoDisplay: false,
                    gaTrack: false,
                    gaId: ''
                }, 'google_translate_element');
            }
        </script>
        <script type="text/javascript" src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
    </head>

    <body>
        <nav class="fixed top-0 right-0 w-full bg-transparent z-50 py-1 pl-0 pr-4 md:p-4" style="background: rgba(0, 0, 0, 0.5); backdrop-filter: blur(10px);">
            <div class="container md:mx-auto flex items-center justify-between flex-wrap gap-2 pl-0 pr-8 md:px-4">
                <!-- Title for Desktop -->
                <!-- Title for Desktop -->
<h1 class="hidden md:block text-white text-2xl font-bold mr-4 notranslate">LiberEther Dapp</h1>
                <!-- Balance Boxes -->
                <div class="flex flex-wrap items-center gap-2 md:gap-4">
                    <div class="balance-box-nav notranslate">
                        <div class="balance-label-nav">LETH</div>
                        <div class="balance-value">0.00</div>
                    </div>
                    <div class="balance-box-nav notranslate">
                        <div class="balance-label-nav">RETH</div>
                        <div class="balance-value">0.00</div>
                    </div>
                    <div class="balance-box-nav notranslate">
                        <div class="balance-label-nav">USD</div>
                        <div class="balance-value">$0.00</div>
                    </div>
                    <div class="balance-box-nav notranslate">
                        <div class="balance-label-nav">Market Cap</div>
                        <div style="color: #4ade80; font-size: 0.8rem;" id="marketCap" class="balance-value">$0</div>
                    </div>
                    <div class="balance-box-nav hidden md:block notranslate">
                        <div class="balance-label-nav">Time Left to Big ðŸ”¥</div>
                        <div id="countdown" class="balance-value" style="font-size: 0.8rem;"></div>
                    </div>
                </div>
                <!-- Connect Wallet Button -->
                <!-- Connect Wallet and Add Token Buttons -->
<div class="flex gap-2">
    <button 
        id="connectWallet" 
        class="bg-[#FF2400] hover:bg-[#ff4d33] text-white font-bold py-1 px-2 md:py-2 md:px-4 rounded-lg transition-colors text-xs md:text-base"
    >
        Connect Wallet
    </button>
    <div class="flex items-center gap-2">
        <button 
            id="addToken" 
            class="bg-[#FF2400] hover:bg-[#ff4d33] text-white font-bold py-1 px-2 md:py-2 md:px-4 rounded-lg transition-colors text-xs md:text-base"
        >
            Add LETH
        </button>
        <div class="flex items-center gap-2">
            <button 
                class="text-white text-xs md:text-sm rounded-full w-6 h-6 flex items-center justify-center bg-[#FF2400] hover:bg-[#ff4d33] border border-[#FF2400] transition-colors"
                onclick="openTutorialModal()"
                title="Tutorial to add LETH manually"
            >
                ?
            </button>
            <div class="md:hidden">
                <div class="balance-label-nav text-xs">Time Left to Big ðŸ”¥</div>
                <div id="countdown-mobile" class="balance-value" style="font-size: 0.8rem;"></div>
            </div>
        </div>
    </div>
        </nav>
        <h1 class="md:hidden" style="font-size: 2.25rem; text-align: center; margin: 9.5rem 0 0.5rem 0; color: white; font-weight: bold; text-shadow: 0 0 10px rgba(255,36,0,0.3);">
            LiberEther Dapp
        </h1>
        
        <!-- Added margin for desktop -->
        <div class="hidden md:block h-24"></div>
    
    
        <div class="header-container">
            <div class="header-image">
                <img src="./images/level2.gif" alt="LETH Ethereum Ninja Scene" class="top-image">
            </div>
            <div style="text-align: center;">
                <img id="rsiGif" class="rsi-gif" alt="Loading Milei Indicator...">
                <div style="margin-top: 10px; margin-bottom: 10px; display: flex; align-items: center; justify-content: center; gap: 10px;">
                    Milei Signal and Chat
                    <span class="info-icon" title="1 ETH shining: Consider waiting to buy LETH. 2 ETH shining: Neutral market conditions. 3 ETH shining with red-eyed and thumbs up Milei: Potentially good time to buy LETH">?</span>
                </div>
                <a href="https://dashboard.etherealize.io/" 
                class="milei-button"
                target="_blank"
                rel="noopener noreferrer"
                title="Ethereum insititutional adoption tracking **Made by Ether Alpha"
                >
                 ETH IS MONEY
             </a>
            </div>
        </div>
        <div class="flex justify-center">
            <div class="flex flex-col md:flex-row gap-4 w-full max-w-4xl mb-8">
                <!-- Deposit Box -->
                <div class="flex-1 bg-[#1e1e1e] p-5 rounded-lg border border-[#2a2a2a]">
                    <div class="text-white text-xl font-bold mb-4" style="display: flex; align-items: center; gap: 10px;">
                        USD Yield+Rewards (Coming Soon)
                        <span class="info-icon" title="Deposit USD to earn yield and RETH token rewards from liquidations. No lockup period required">?</span>
                    </div>
                    
                    <!-- Auto Invest Toggle -->
                    <div style="text-align: right; margin-bottom: 10px;">
                        <button id="autoInvestToggle" class="auto-invest-toggle" onclick="toggleAutoInvest()">
                            Auto Invest Reward OFF
                        </button>
                    </div>
        
                    <div class="deposit-header">
                        <div class="toggle-buttons">
                            <button class="toggle-button active" onclick="toggleAction('deposit')">Deposit</button>
                            <button class="toggle-button" onclick="toggleAction('withdraw')">Withdraw</button>
                            <button class="toggle-button" onclick="claimRewards()">Claim Rewards</button>
                        </div>
                    </div>
        
                    <input type="number" class="amount-input" value="0.00" min="0" step="0.01">
                    
                    <div class="apy-display">
                        <span>Amount: <span id="apyValue">0</span>%</span>
                        <span>Max: 100%</span>
                    </div>
                    
                    <input 
                        type="range" 
                        id="apySlider" 
                        class="apy-slider" 
                        min="0" 
                        max="100" 
                        value="0"
                        oninput="updateAPY(this.value)"
                    >
        
                    <button class="w-full bg-[#FF2400] hover:bg-[#ff4d33] text-white font-bold py-3 rounded-lg mt-4 transition-colors">
                        Deposit
                    </button>
        
                    <div class="pool-share">
                        Pool share: 0% 
                        <span class="info-icon" title="Percentage of your USD deposit compared to the total deposited in this pool.">?</span>
                    </div>
                </div>
                
                
                <!-- Uniswap Widget -->
                <div class="flex-1 bg-[#1e1e1e] p-5 rounded-lg border border-[#2a2a2a]">
                    <div class="text-white text-xl font-bold mb-4 flex items-center gap-2">
                        Swap Tokens
                        <span class="info-icon" title="Trade tokens using the Uniswap Protocol">?</span>
                    </div>
                    
                    <div class="uniswap-container min-h-[460px] flex items-center justify-center">
                        <iframe
                            id="uniswapIframe"
                            class="uniswap-iframe"
                            src="https://app.uniswap.org/#/swap?exactField=input&exactAmount=0.1&inputCurrency=ETH&outputCurrency=0xf7acec1b4580f436866f96fe9eba6059039ea6f7"
                            height="660"
                            width="100%"
                            style="border: 0; border-radius: 10px; background-color: transparent;"
                            allow="clipboard-write; web3-provider-request; ethereum-provider"
                            sandbox="allow-same-origin allow-scripts allow-forms allow-popups allow-popups-to-escape-sandbox"
                        ></iframe>
                    </div>
                </div>
            </div>
        </div>
        <div class="container">
            <h1 class="flex items-center justify-center gap-2 text-xl text-white mb-4">
                LETH Price Today
                <span class="info-icon" title="Current live USD price per LETH token in the market">?</span>
            </h1>
            
            <div class="flex flex-col items-center gap-2 price-container">
                <div id="tokenPrice" class="value">Loading...</div>
                
                <!-- ATH Display -->
                <div class="ath-display">
                    All Time High: <span id="athPrice">(price loading)</span>
                    <span id="athDate" class="ml-2"></span>
                </div>
                
                <div id="priceChange" class="performance"></div>
            </div>
        </div>
    
    <div class="container">
        <h2 style="display: flex; align-items: center; justify-content: center; gap: 10px; font-size: 1.25rem; color: white;">
            Token Supply Remaining
            <span class="info-icon" style="margin-top: 5px;" title="Total existing LETH tokens. This number continuously decreases as tokens are burned, and no new tokens can be created">?</span>
        </h2>
        <div class="value" id="tokenSupply">Loading...</div>
        <div id="supplyInfo"></div>
        <div id="burnedAmount"></div>
    </div>
    
    <div class="container">
        <h2 style="display: flex; align-items: center; justify-content: center; gap: 10px; font-size: 1.25rem; color: white;">
            LETH/ETH Performance (1Y)
            <span class="info-icon" style="margin-top: 5px;" title="Additional return percentage if you had invested in LETH instead of ETH one year ago">?</span>
        </h2>
        <div id="performance" class="performance">Loading...</div>
    </div>
    
    <div class="container">
        <h2 style="display: flex; align-items: center; justify-content: center; gap: 10px; font-size: 1.25rem; color: white;">
            Top 13 LETH Holders
            <span class="info-icon" style="margin-top: 5px;" title="The 13 largest LETH holders, aka Gotei 13 who have special privileges as project co-runners">?</span>
        </h2>
        <div class="holders-buttons">
            <button class="milei-button" onclick="toggleHoldersList()">Click to view list</button>
        </div>
        <div id="holdersList" style="display: none;">
            <table class="ranking-table hidden-table">
                <thead>
                    <tr>
                        <th>Rank</th>
                        <th>Holder</th>
                        <th>Amount</th>
                    </tr>
                </thead>
                <tbody id="rankingTableBody"></tbody>
            </table>
        </div>
    </div>

    <div id="imageModal" class="modal">
        <img class="modal-content modal-img" id="modalImg">
    </div>
    <div class="container roadmap-container">
        <h2 style="display: flex; align-items: center; justify-content: center; gap: 10px; font-size: 1.25rem; color: white;">
            LiberEther Roadmap
            <span class="info-icon" style="margin-top: 5px;" title="Expected timeline for the project's goals and milestones">?</span>
        </h2>
        <button class="milei-button" onclick="toggleRoadmap()">Click to view roadmap</button>
        <div id="roadmapContent" style="display: none;">
            <div class="pdf-container">
                <iframe id="roadmapImage" 
        src="https://drive.google.com/file/d/1bPJjkYmqaLcm9FiZiUREQyxlqvMUcnCs/preview"
        class="roadmap-pdf" 
        frameborder="0"
        scrolling="auto"
        allowfullscreen>
</iframe>
            </div>
        </div>
    </div>
    <script>
        const RSI_UPDATE_INTERVAL = 60000; // Update every 1 minute
// Cache variables
let rsiCache = {
    value: null,
    timestamp: 0
};
let ethPriceCache = {
    value: null,
    timestamp: 0
};
const CACHE_DURATION = 5 * 60 * 1000; // 5 minutes cache

// Cache helper function
function isCacheValid(cache) {
    return cache.timestamp && (Date.now() - cache.timestamp < CACHE_DURATION);
}
    
        
const RSI_GIF_HIGH = window.CONFIG.RSI_GIFS.HIGH;
const RSI_GIF_VERY_HIGH = window.CONFIG.RSI_GIFS.VERY_HIGH;
const RSI_GIF_LOW = window.CONFIG.RSI_GIFS.LOW;
    
        // UI Interaction Functions
        function toggleAction(action) {
            const buttons = document.querySelectorAll('.toggle-button');
            buttons.forEach(button => {
                button.classList.remove('active');
                if(button.textContent.toLowerCase() === action) {
                    button.classList.add('active');
                }
            });
            document.getElementById('actionTitle').textContent = 
                action.charAt(0).toUpperCase() + action.slice(1);
        }
    
        function toggleHoldersList() {
    const holdersList = document.getElementById('holdersList');
    const toggleButton = document.querySelector('.container .milei-button');
    
    if (!holdersList || !toggleButton) return;
    
    if (holdersList.style.display === 'none' || holdersList.style.display === '') {
        holdersList.style.display = 'block';
        holdersList.classList.add('visible');
        toggleButton.textContent = 'Hide list';
        loadHolders();
    } else {
        holdersList.style.display = 'none';
        holdersList.classList.remove('visible');
        toggleButton.textContent = 'Click to view list';
    }
}
    
function toggleRoadmap() {
    const roadmapContent = document.getElementById('roadmapContent');
    const button = document.querySelector('.roadmap-container button');
    
    if (roadmapContent.style.display === 'none' || roadmapContent.style.display === '') {
        roadmapContent.style.display = 'block';
        button.textContent = 'Hide roadmap';
    } else {
        roadmapContent.style.display = 'none';
        button.textContent = 'Click to view roadmap';
    }
}
    
        function claimRewards() {
            console.log('Claim rewards clicked');
        }
    
        
    
        // API and Data Functions
        async function getRSI() {
    try {
        // Check cache first
        if (isCacheValid(rsiCache)) {
            console.log('Using cached RSI value');
            return rsiCache.value;
        }

        console.log('Fetching fresh RSI data from Binance...');
        const PERIODS = 14;
        
        // Get 4h candlesticks from Binance
        const response = await fetch('https://api.binance.com/api/v3/klines?symbol=ETHUSDT&interval=4h&limit=100');
        
        if (!response.ok) {
            throw new Error(`Binance API HTTP error! status: ${response.status}`);
        }
        
        const klineData = await response.json();

        // Validate data
        if (!Array.isArray(klineData) || klineData.length < PERIODS + 1) {
            throw new Error('Insufficient data points for RSI calculation');
        }

        // Extract closing prices (index 4 in Binance kline data)
        const prices = klineData
            .map(candle => parseFloat(candle[4]))
            .filter(price => !isNaN(price));

        // Calculate price changes
        const changes = [];
        for (let i = 1; i < prices.length; i++) {
            changes.push(prices[i] - prices[i - 1]);
        }

        // Separate gains and losses
        const gains = changes.map(change => change > 0 ? change : 0);
        const losses = changes.map(change => change < 0 ? Math.abs(change) : 0);

        // Calculate initial averages
        let avgGain = gains.slice(0, PERIODS).reduce((sum, gain) => sum + gain, 0) / PERIODS;
        let avgLoss = losses.slice(0, PERIODS).reduce((sum, loss) => sum + loss, 0) / PERIODS;

        // Calculate smoothed averages
        for (let i = PERIODS; i < gains.length; i++) {
            avgGain = ((avgGain * 13) + gains[i]) / PERIODS;
            avgLoss = ((avgLoss * 13) + losses[i]) / PERIODS;
        }

        // Calculate RSI
        const rs = avgLoss === 0 ? 100 : avgGain / avgLoss;
        const rsiValue = 100 - (100 / (1 + rs));

        // Update cache
        rsiCache.value = rsiValue;
        rsiCache.timestamp = Date.now();

        console.log('Calculated RSI:', rsiValue);
        return rsiValue;
    } catch (error) {
        console.error('Error calculating RSI:', error);
        return null;
    }
}
    
async function updateRSIGif() {
    try {
        const rsi = await getRSI();
        const gifElement = document.getElementById('rsiGif');
        
        if (!gifElement) return;

        if (rsi === null) {
    console.error('RSI calculation failed');
    gifElement.src = RSI_GIF_HIGH; // New code - shows 2 ETHs when error
    return;
}

        console.log('Updating GIF for RSI:', rsi);
        
        if (rsi >= 60) {
            gifElement.src = RSI_GIF_VERY_HIGH;
            console.log('RSI is very high (â‰¥60) - Potentially good time to hodl');
        } else if (rsi >= 35) {
            gifElement.src = RSI_GIF_HIGH;
            console.log('RSI is moderate (35-60) - Normal market conditions');
        } else {
            gifElement.src = RSI_GIF_LOW;
            console.log('RSI is low (<35) - Consider waiting');
        }
    } catch (error) {
    console.error('Error updating RSI GIF:', error);
    const gifElement = document.getElementById('rsiGif');
    if (gifElement) {
        gifElement.src = RSI_GIF_HIGH; // New code
    }
}
}
    
async function fetchLETHPrice() {
    return priceData.currentPrice;
}
    
        function calculateUSDValue(LETHAmount) {
            return (LETHAmount * currentPrice).toLocaleString(undefined, {
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            });
        }
    
        function getOrdinal(n) {
            const s = ["th", "st", "nd", "rd"];
            const v = n % 100;
            return s[(v - 20) % 10] || s[v] || s[0];
        }
    
        async function loadHolders() {
    try {
        currentPrice = await fetchLETHPrice();
        const timestamp = new Date().getTime();
        const response = await fetch(`holders.json?t=${timestamp}`);
        
        if (!response.ok) {
            throw new Error('Failed to fetch holders data');
        }
        
        const holders = await response.json();
        const tableBody = document.getElementById('rankingTableBody');
        
        if (!tableBody) return;
        
        tableBody.innerHTML = '';

        holders.forEach((holder, index) => {
            const row = document.createElement('tr');
            
            // Special handling for Sennin to show "Honour Member" instead of 14th
            if (holder.name === "Sennin") {
                row.innerHTML = `
                    <td class="rank-number">Honour Member</td>
                    <td class="holder-cell">
                        <div class="holder-container">
                            <img src="${holder.image}?t=${timestamp}" alt="${holder.name}" class="holder-image" onclick="openModal(this.src)">
                            <div class="holder-info">
                                <div class="holder-name notranslate">${holder.name}</div>
                                ${holder.description ? `<div class="holder-description">${holder.description}</div>` : ''}
                            </div>
                        </div>
                    </td>
                    <td class="amount-cell">
                        <div class="holder-amount notranslate">${holder.amount.toLocaleString()} LETH</div>
                        <div class="holder-amount">($${calculateUSDValue(holder.amount)})</div>
                    </td>
                `;
            } else {
                row.innerHTML = `
                    <td class="rank-number">${index + 1}${getOrdinal(index + 1)}</td>
                    <td class="holder-cell">
                        <div class="holder-container">
                            <img src="${holder.image}?t=${timestamp}" alt="${holder.name}" class="holder-image" onclick="openModal(this.src)">
                            <div class="holder-info">
                                <div class="holder-name notranslate">${holder.name}</div>
                                ${holder.description ? `<div class="holder-description">${holder.description}</div>` : ''}
                            </div>
                        </div>
                    </td>
                    <td class="amount-cell">
                        <div class="holder-amount notranslate">${holder.amount.toLocaleString()} LETH</div>
                        <div class="holder-amount">($${calculateUSDValue(holder.amount)})</div>
                    </td>
                `;
            }
            
            tableBody.appendChild(row);
        });
    } catch (error) {
        console.error('Error loading holders:', error);
        const tableBody = document.getElementById('rankingTableBody');
        if (tableBody) {
            tableBody.innerHTML = '<tr><td colspan="3" style="text-align: center; color: red;">Error loading holders data. Please try again.</td></tr>';
        }
    }
}
    
        function openModal(src) {
            const modal = document.getElementById('imageModal');
            const modalImg = document.getElementById('modalImg');
            modal.style.display = "block";
            modalImg.src = src;
        }
        let lastMarketCap = 0;
let isUpdating = false;

async function updateMarketCap() {
    // Prevent multiple simultaneous updates
    if (isUpdating) return;
    
    try {
        isUpdating = true;
        
        // Define our constants
        const CIRCULATING_SUPPLY = 231209; // Your circulating supply
        
        // Get current price from priceData
        const currentPrice = Number(priceData.currentPrice);
        
        // Calculate market cap
        const marketCap = currentPrice * CIRCULATING_SUPPLY;
        
        // Only update if the value has changed
        if (marketCap !== lastMarketCap) {
            lastMarketCap = marketCap;
            
            // Update market cap display
            const marketCapEl = document.getElementById('marketCap');
            if (marketCapEl) {
                marketCapEl.textContent = `$${marketCap.toLocaleString(undefined, {maximumFractionDigits: 0})}`;
            }
        }
    } catch (error) {
        console.error('Error updating market cap:', error);
    } finally {
        isUpdating = false;
    }
}
        async function updateData() {
    try {
        // Define our supply numbers
        const TOTAL_SUPPLY = 600000;
        const LOCKED_TOKENS = 366791;        
        const CIRCULATING_SUPPLY = 231209; // Used only for market cap
        const BURNED_TOKENS = 0;
        
        // Get current price
        currentPrice = Number(priceData.currentPrice);
        
        // Market cap is now handled by updateMarketCap function

        // Update token price display
        const tokenPriceEl = document.getElementById('tokenPrice');
        if (tokenPriceEl) {
            tokenPriceEl.textContent = `$${currentPrice.toFixed(2)}`;
        }

        // Update token supply info
        const tokenSupplyEl = document.getElementById('tokenSupply');
        const supplyInfoEl = document.getElementById('supplyInfo');
        const burnedAmountEl = document.getElementById('burnedAmount');
        
        if (tokenSupplyEl) {
            tokenSupplyEl.textContent = `${TOTAL_SUPPLY.toLocaleString()} LETH`;
        }
        if (supplyInfoEl) {
            supplyInfoEl.textContent = `Total Supply Created Originally: ${TOTAL_SUPPLY.toLocaleString()} LETH`;
        }
        if (burnedAmountEl) {
            burnedAmountEl.innerHTML = `
                <div class="burned-amount-container">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#FF2400" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: -1px;">
                        <path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"/>
                    </svg>
                    Burned: ${BURNED_TOKENS.toLocaleString()} LETH
                </div>
            `;
        }

        // Calculate and update performance
        const performanceValue = await getPerformanceData();
        const performanceEl = document.getElementById('performance');
        if (performanceEl && performanceValue !== null) {
            performanceEl.textContent = `${performanceValue >= 0 ? '+' : ''}${performanceValue.toFixed(2)}% vs ETH (1Y)`;
            performanceEl.className = `performance ${performanceValue >= 0 ? 'positive' : 'negative'}`;
        }
        
        // Calculate price change since launch
        const initialPrice = 0.10;
        const priceChange = ((currentPrice - initialPrice) / initialPrice) * 100;
        const priceChangeEl = document.getElementById('priceChange');
        if (priceChangeEl) {
            priceChangeEl.textContent = `${priceChange > 0 ? '+' : ''}${priceChange.toFixed(1)}% (Since Launch)`;
            priceChangeEl.className = `performance ${priceChange >= 0 ? 'positive' : 'negative'}`;
        }
    } catch (error) {
        console.error('Error:', error);
    }
}
    
        
async function getPerformanceData() {
    try {
        console.log('Calculating performance data...');
        
        // Use manual price instead of fetching
        const currentLETHPrice = priceData.currentPrice;
        const initialLETHPrice = 0.10; // Initial LETH price
        
        // Get historical ETH price (1 year ago)
        const oneYearAgo = Date.now() - (365 * 24 * 60 * 60 * 1000);
        const historicalResponse = await fetch(
            `https://api.binance.com/api/v3/klines?symbol=ETHUSDT&interval=1d&startTime=${oneYearAgo}&limit=1`
        );
        
        if (!historicalResponse.ok) {
            throw new Error('Failed to fetch historical ETH price');
        }
        
        const historicalData = await historicalResponse.json();
        
        // Get current ETH price
        const currentResponse = await fetch('https://api.binance.com/api/v3/ticker/price?symbol=ETHUSDT');
        const currentData = await currentResponse.json();
        
        if (!currentData?.price || !Array.isArray(historicalData) || !historicalData[0]) {
            throw new Error('Invalid price data');
        }

        const oldEthPrice = parseFloat(historicalData[0][4]); // Close price
        const currentEthPrice = parseFloat(currentData.price);

        // Calculate returns
        const ethReturn = ((currentEthPrice - oldEthPrice) / oldEthPrice) * 100;
        const LETHReturn = ((currentLETHPrice - initialLETHPrice) / initialLETHPrice) * 100;

        // Calculate relative performance
        const performanceDiff = LETHReturn - ethReturn;
        
        console.log('Performance calculation:', {
            currentLETHPrice,
            initialLETHPrice,
            currentEthPrice,
            oldEthPrice,
            ethReturn,
            LETHReturn,
            performanceDiff
        });

        return performanceDiff;
    } catch (error) {
        console.error('Error calculating performance:', error);
        return null;
    }
}
    
        // Modal click handler
        window.onclick = function(event) {
            const modal = document.getElementById('imageModal');
            if (event.target === modal || event.target.classList.contains('modal-img')) {
                modal.style.display = "none";
            }
        };
    
        // Initialize
        updateData();
        updateRSIGif();
    
        // Set intervals for updates
        // Set intervals for updates
setInterval(updateData, 30000);
setInterval(updateRSIGif, RSI_UPDATE_INTERVAL);
setInterval(updateMarketCap, 30000); // Add this line
    // Add these new functions for the APY slider and Auto Invest toggle
    function updateAPY(value) {
        document.getElementById('apyValue').textContent = value;
        const slider = document.getElementById('apySlider');
        const percentage = (value / slider.max) * 100;
        slider.style.background = `linear-gradient(to right, #FF2400 0%, #FF2400 ${percentage}%, #2a2a2a ${percentage}%, #2a2a2a 100%)`;
    }

    function toggleAutoInvest() {
        const button = document.getElementById('autoInvestToggle');
        const isActive = button.classList.contains('active');
        if (isActive) {
            button.classList.remove('active');
            button.textContent = 'Auto Invest Reward OFF';
        } else {
            button.classList.add('active');
            button.textContent = 'Auto Invest Reward ON';
        }
    }
    function startHoldersAutoRefresh() {
    setInterval(() => {
        const holdersList = document.getElementById('holdersList');
        if (holdersList && holdersList.style.display !== 'none') {
            loadHolders();
        }
    }, 30000);
}
    </script>


    
    <!-- Web3 Integration -->
<!-- Web3 Integration -->

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Connect wallet button
        const connectButton = document.getElementById('connectWallet');
        
        // LETH token contract address
        const LETH_ADDRESS = '0xf7acec1b4580f436866f96fe9eba6059039ea6f7';
        // Minimal ABI for token balance
        const ERC20_ABI = [
            {
                "constant": true,
                "inputs": [{"name": "_owner", "type": "address"}],
                "name": "balanceOf",
                "outputs": [{"name": "balance", "type": "uint256"}],
                "type": "function"
            },
            {
                "constant": true,
                "inputs": [],
                "name": "decimals",
                "outputs": [{"name": "", "type": "uint8"}],
                "type": "function"
            }
        ];
        
// Function to update token balances
// Function to update token balances
async function updateBalances(address) {
    try {
        const balanceBoxes = document.querySelectorAll('.balance-box-nav .balance-value');
        if (!balanceBoxes || balanceBoxes.length < 3) return;
        
        // Reset balances first
        balanceBoxes[0].textContent = '0.00';
        balanceBoxes[1].textContent = '0.00';
        balanceBoxes[2].textContent = '$0.00';
        
        if (!address || !window.ethereum) return;
        
        // Create web3 provider
        const provider = new ethers.providers.Web3Provider(window.ethereum);
        
        // Contract addresses
        const LETH_ADDRESS = '0xf7acec1b4580f436866f96fe9eba6059039ea6f7';
        const RETH_ADDRESS = '0xEC70Dcb4A1EFa46b8F2D97C310C9c4790ba5ffA8';
        
        // Create contract instances
        const lethContract = new ethers.Contract(LETH_ADDRESS, ERC20_ABI, provider);
        const rethContract = new ethers.Contract(RETH_ADDRESS, ERC20_ABI, provider);
        
        // Get token decimals and balances (in parallel for efficiency)
        const [lethDecimals, rethDecimals, lethBalance, rethBalance] = await Promise.all([
            lethContract.decimals(),
            rethContract.decimals(),
            lethContract.balanceOf(address),
            rethContract.balanceOf(address)
        ]);
        
        // Format the balances with ethers.js
        let formattedLeth = ethers.utils.formatUnits(lethBalance, lethDecimals);
        formattedLeth = parseFloat(formattedLeth).toFixed(2);
        
        let formattedReth = ethers.utils.formatUnits(rethBalance, rethDecimals);
        formattedReth = parseFloat(formattedReth).toFixed(2);
        
        // Update LETH and RETH balance displays
        balanceBoxes[0].textContent = formattedLeth;
        balanceBoxes[1].textContent = formattedReth;
        
        // Get LETH price from UI display
        let lethPrice = 0.37; // Default fallback value
        const tokenPriceEl = document.getElementById('tokenPrice');
        
        if (tokenPriceEl && tokenPriceEl.textContent) {
            const priceText = tokenPriceEl.textContent.replace('$', '').trim();
            const parsedPrice = parseFloat(priceText);
            
            if (!isNaN(parsedPrice) && parsedPrice > 0) {
                lethPrice = parsedPrice;
            }
        }
        
        // Get RETH price (fetch from coingecko or use ETH price as approximation)
        let rethPrice = 3500; // Default fallback to approximate ETH price
        try {
            // Try to fetch ETH price from Binance API as fallback
            const ethResponse = await fetch('https://api.binance.com/api/v3/ticker/price?symbol=ETHUSDT');
            if (ethResponse.ok) {
                const ethData = await ethResponse.json();
                rethPrice = parseFloat(ethData.price);
                console.log('Using ETH price for RETH:', rethPrice);
            }
        } catch (error) {
            console.log('Error fetching ETH price, using default:', error);
        }
        
        // Calculate USD values
        const lethUsdValue = parseFloat(formattedLeth) * lethPrice;
        const rethUsdValue = parseFloat(formattedReth) * rethPrice;
        const totalUsdValue = lethUsdValue + rethUsdValue;
        
        // Update USD value display
        balanceBoxes[2].textContent = `$${totalUsdValue.toFixed(2)}`;
        
        console.log('Balance update complete:', {
            lethBalance: formattedLeth,
            rethBalance: formattedReth,
            lethPrice: lethPrice,
            rethPrice: rethPrice,
            lethUsdValue: lethUsdValue,
            rethUsdValue: rethUsdValue,
            totalUsdValue: totalUsdValue
        });
    } catch (error) {
        console.error('Error updating balances:', error);
    }
}
// Listen for price updates and recalculate balances
window.addEventListener('priceUpdate', function() {
    console.log('Price updated, recalculating balances');
    if (window.ethereum && window.ethereum.selectedAddress) {
        updateBalances(window.ethereum.selectedAddress);
    }
});
        
        if (connectButton) {
            connectButton.onclick = async function() {
                try {
                    console.log('Connect wallet button clicked');
                    
                    // Check if MetaMask is installed
                    if (typeof window.ethereum === 'undefined') {
                        alert('MetaMask is not installed. Please install MetaMask to continue.');
                        return;
                    }
                    
                    // Request accounts
                    const accounts = await window.ethereum.request({
                        method: 'eth_requestAccounts'
                    });
                    
                    if (!accounts || accounts.length === 0) {
                        alert('No accounts found. Please unlock your MetaMask and try again.');
                        return;
                    }
                    
                    const address = accounts[0];
                    
                    // Update button text
                    connectButton.textContent = `${address.slice(0, 6)}...${address.slice(-4)}`;
                    
                    // Try to switch to Arbitrum One network
                    try {
                        await window.ethereum.request({
                            method: 'wallet_switchEthereumChain',
                            params: [{ chainId: '0xa4b1' }], // Arbitrum One
                        });
                    } catch (switchError) {
                        // If network doesn't exist, try to add it
                        if (switchError.code === 4902) {
                            try {
                                await window.ethereum.request({
                                    method: 'wallet_addEthereumChain',
                                    params: [{
                                        chainId: '0xa4b1',
                                        chainName: 'Arbitrum One',
                                        nativeCurrency: {
                                            name: 'ETH',
                                            symbol: 'ETH',
                                            decimals: 18
                                        },
                                        rpcUrls: ['https://arb1.arbitrum.io/rpc'],
                                        blockExplorerUrls: ['https://arbiscan.io/']
                                    }],
                                });
                            } catch (addError) {
                                console.error('Error adding network:', addError);
                            }
                        }
                    }
                    
                    // Update token balances
                    await updateBalances(address);
                    
                    // Set up account change listener
                    window.ethereum.removeListener('accountsChanged', handleAccountChange);
                    window.ethereum.on('accountsChanged', handleAccountChange);
                    
                    console.log('Successfully connected to wallet:', address);
                    
                    // Send message to Uniswap iframe if needed
                    try {
                        const uniswapIframe = document.querySelector('.uniswap-iframe');
                        if (uniswapIframe && uniswapIframe.contentWindow) {
                            const message = {
                                type: 'CONNECT_WALLET',
                                address: address,
                                chainId: parseInt('0xa4b1', 16), // Convert hex to decimal
                                isConnected: true
                            };
                            uniswapIframe.contentWindow.postMessage(message, '*');
                        }
                    } catch (iframeError) {
                        console.log('Error sending message to iframe:', iframeError);
                    }
                    
                } catch (error) {
                    console.error('Wallet connection error:', error);
                    alert('Failed to connect wallet: ' + error.message);
                }
            };
        }
        
        // Handle account changes in MetaMask
        function handleAccountChange(accounts) {
            if (accounts.length === 0) {
                // User disconnected wallet
                if (connectButton) {
                    connectButton.textContent = 'Connect Wallet';
                }
                
                // Reset balances
                const balanceBoxes = document.querySelectorAll('.balance-box-nav .balance-value');
                if (balanceBoxes && balanceBoxes.length >= 3) {
                    balanceBoxes[0].textContent = '0.00';
                    balanceBoxes[1].textContent = '0.00';
                    balanceBoxes[2].textContent = '$0.00';
                }
            } else {
                // Account changed, update UI
                const newAddress = accounts[0];
                if (connectButton) {
                    connectButton.textContent = `${newAddress.slice(0, 6)}...${newAddress.slice(-4)}`;
                }
                
                // Update balances for new account
                updateBalances(newAddress);
            }
        }
        
        // Handle "Add LETH" button
        const addTokenButton = document.getElementById('addToken');
        if (addTokenButton) {
            addTokenButton.onclick = async function() {
                try {
                    if (typeof window.ethereum === 'undefined') {
                        alert('Please install MetaMask first!');
                        return;
                    }
    
                    await window.ethereum.request({
                        method: 'wallet_watchAsset',
                        params: {
                            type: 'ERC20',
                            options: {
                                address: '0xf7acec1b4580f436866f96fe9eba6059039ea6f7',
                                symbol: 'LETH',
                                decimals: 18,
                            }
                        }
                    });
                } catch (error) {
                    console.error(error);
                    alert('Error adding token to MetaMask');
                }
            };
        }
        
        // Initialize market cap
        if (typeof updateMarketCap === 'function') {
            updateMarketCap();
        }
        
        // Initialize display data
        if (typeof updateData === 'function') {
            updateData();
        }
        
        if (typeof updateRSIGif === 'function') {
            updateRSIGif();
        }
        
        // Start holders refresh
        if (typeof startHoldersAutoRefresh === 'function') {
            startHoldersAutoRefresh();
        }
        
        // Check if already connected
        if (window.ethereum && window.ethereum.selectedAddress) {
            const address = window.ethereum.selectedAddress;
            if (connectButton) {
                connectButton.textContent = `${address.slice(0, 6)}...${address.slice(-4)}`;
            }
            updateBalances(address);
        }
    });
    </script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Create social buttons container
        const socialButtons = document.getElementById('social-buttons');
        
        // Create buttons HTML
const buttonsHTML = `
    <a href="https://t.me/+B9PHTaCwSQ03YWU0" target="_blank" rel="noopener noreferrer" class="social-button">
        <img src="https://cdn.jsdelivr.net/npm/@tabler/icons@2.47.0/icons/brand-telegram.svg" alt="Telegram" />
    </a>
    <a href="https://x.com/LiberEther" target="_blank" rel="noopener noreferrer" class="social-button">
        <img src="https://cdn.jsdelivr.net/npm/@tabler/icons@2.47.0/icons/brand-x.svg" alt="X (Twitter)" />
    </a>
    <a href="https://github.com/gogoneriel/AKM" target="_blank" rel="noopener noreferrer" class="social-button">
        <img src="https://cdn.jsdelivr.net/npm/@tabler/icons@2.47.0/icons/brand-github.svg" alt="GitHub" />
    </a>
    <button onclick="openWhitepaper()" class="social-button">
        <img src="https://cdn.jsdelivr.net/npm/@tabler/icons@2.47.0/icons/file-text.svg" alt="Whitepaper" />
    </button>
    <a href="https://liberether.com/academy/" target="_blank" rel="noopener noreferrer" class="social-button">
        <img src="https://cdn.jsdelivr.net/npm/@tabler/icons@2.47.0/icons/school.svg" alt="Academy Page" />
    </a>
`;
        
        socialButtons.innerHTML = buttonsHTML;
    
        // Create whitepaper modal
        const modalHTML = `
    <div id="whitepaper-modal" class="whitepaper-modal">
        <div class="whitepaper-content">
            <button onclick="closeWhitepaper()" class="close-button">Ã—</button>
            <div style="line-height: 1.6;">
    <h2 style="font-size: 1.5rem; margin-bottom: 1rem;">LIberEther Project White Paper</h2>

<h3 style="font-size: 1.2rem; margin-top: 1rem;">Introduction</h3>
<p style="margin: 0.5rem 0">The LIberEther Project is an initiative rooted in Ethereum maximalism, libertarianism, and entrepreneurship, aiming to create a self-sustaining, decentralized ecosystem where community members can thrive economically through DeFi. We seek to build this ecosystem through education, with a strong leadership that will lead by example. This educational initiative will be realized through the LiberEther Academy program. Here, our leader, Neriel, will create both in-person and digital courses aimed at teaching the average person how to navigate and leverage DeFi, focusing exclusively on projects aligned with Ethereum. This approach ensures that education is not only accessible but also practical, empowering individuals to enhance their financial literacy and participation within the Ethereum ecosystem.</p>

<h3 style="font-size: 1.2rem; margin-top: 1rem;">Project Overview</h3>

<h4 style="font-size: 1.1rem; margin-top: 0.8rem;">Core Philosophy</h4>
<ul style="margin-left: 1.5rem; list-style-type: disc;">
    <li>Ethereum Maximalism: Utilizing Ethereum for its proven security, decentralization, and smart contract capabilities.</li>
    <li>Libertarianism: Advocating for minimal governance and maximum individual freedom within the project's community.</li>
    <li>Entrepreneurship: Fostering an environment where new business ideas can be incubated using blockchain and other technologies.</li>
</ul>

<h4 style="font-size: 1.1rem; margin-top: 0.8rem;">Token Details</h4>
<ul style="margin-left: 1.5rem; list-style-type: none;">
    <li>Token Name: LiberEther</li>
    <li>Token Ticker: LETH</li>
    <li>Token Address: 0xf7acec1b4580f436866f96fe9eba6059039ea6f7</li>
    <li>Token Supply:</li>
    <li>- Circulating Supply: 600,000 LETH</li>
    <li>- Total Supply: 600,000 LETH</li>
    <li>- Burned: 0 LETH</li>
    <li>- Tokens Lock Temporary Contract: (6 months until we build one with vesting) 0xa5a53b945dCbB2Bbeae5a02c1E6bF1897a019C68</li>
</ul>

<h3 style="font-size: 1.2rem; margin-top: 1rem;">Financial Structure</h3>
<p style="margin: 0.5rem 0">Decentralized Ecosystem: Our ecosystem exclusively utilizes decentralized projects aligned with Ethereum, ensuring compatibility and security:</p>
<ul style="margin-left: 1.5rem; list-style-type: disc;">
    <li>Uniswap V4 for token exchanges, providing efficient and decentralized trading.</li>
    <li>RETH for the liquidity pool, supporting Ethereum's staking ecosystem by enabling staked ETH participation.</li>
    <li>Nerite RETH Stability Pool for USD yield and rewards, offering a mechanism to earn stablecoin-based returns.</li>
</ul>
<p style="margin: 0.5rem 0">WarChest: The WarChest is a strategic reserve designed to generate revenue while maintaining security:</p>
<ul style="margin-left: 1.5rem; list-style-type: disc;">
    <li>It is primarily composed of SNX tokens that are staked to generate revenue, making up the majority of the WarChest's value.</li>
    <li>Additionally, the WarChest holds LETH, which is already secured in a multi-signature wallet.</li>
</ul>
<p style="margin: 0.5rem 0">New Earnings Allocation: To optimize yield and manage exposure effectively, we have implemented a new strategy for handling incoming earnings:</p>
<ul style="margin-left: 1.5rem; list-style-type: disc;">
    <li>Any new earnings are split evenly: 50% allocated to RETH and 50% allocated to USDN.</li>
    <li>The USDN portion (a USD-pegged stablecoin) is then deposited into the Nerite RETH Stability Pool, where it generates additional yield in US stablecoins.</li>
</ul>


<h3 style="font-size: 1.2rem; margin-top: 1rem;">Tokenomics and Distribution</h3>
<h4 style="font-size: 1.1rem; margin-top: 0.8rem;">Token Distribution Dynamics:</h4>
<ul style="margin-left: 1.5rem; list-style-type: disc;">
    <li>Initial allocation: 10% to team, 10% to seed investors at $0.10 per LETH (former AKM).</li>
    <li>Top 5 holders control 65% of circulating supply due to continuous buying since inception on September 1st, 2023, and early yield distribution, check how we will mitigate that below.</li>
</ul>

<h4 style="font-size: 1.1rem; margin-top: 0.8rem;">Deflationary Mechanism:</h4>
<ul style="margin-left: 1.5rem; list-style-type: disc;">
    <li>40% of the total supply burned, originally was called AKM and had 1 million total supply.</li>
    <li>Future buyback and burns managed by LETH's AI's profits.</li>
    <li>All future businesses fostered by LiberEther will buy back and burn LETH tokens with 20% of their profits.</li>
</ul>
<p style="margin: 0.5rem 0">Additional Commitment by the Leader and top holders:</p>
<ul style="margin-left: 1.5rem; list-style-type: disc;">
    <li>Neriel, who is the biggest token holder, will burn 100% of their tokens, in exchange for being able to always have a small loan with 10% LTV (Loan-to-Value) at 0% interest, up to 20% of the WarChest amount of his LETH burned amount. This arrangement makes it impossible for leadership to exit the project, thereby ensuring the most leadership alignment of all projects and avoiding future sell pressure.</li>
</ul>
<p style="margin: 0.5rem 0">Lock/Vesting Period: A 10-year lock and vesting schedule for remaining top 2 to 5 holders (2 years lock-up + 8 years linear vesting) to ensure long-term commitment.</p>

<h3 style="font-size: 1.2rem; margin-top: 1rem;">Governance and Immutability</h3>
<p style="margin: 0.5rem 0">Minimal Governance: Designed for protocol stability and longevity.</p>

<h3 style="font-size: 1.2rem; margin-top: 1rem;">AI Integration</h3>
<ul style="margin-left: 1.5rem; list-style-type: disc;">
    <li>Milei: AI chatbot and reliable and easy indicator for a more efficient investment strategy (DCA).</li>
    <li>Vitalik: AI for advocacy and fundraising on X and Telegram, converting donations to LETH for burning.</li>
    <li>Fraga: AI bot for DeFi arbitrage, buying LETH for burning.</li>
</ul>

<h3 style="font-size: 1.2rem; margin-top: 1rem;">Decentralized Applications (DApps)</h3>
<ul style="margin-left: 1.5rem; list-style-type: disc;">
    <li>USD Yield & Liquidations Rewards: From Nerite, a friendly fork of Liquity v2.</li>
    <li>Swap Interface: Utilizes Uniswap V4 for swaps and LP with a 3.5% fee, which helps to protect against MEV, keep short-term speculators away, bring long-term investors on board, incentivize OTC trading, and help fund the project as well as support liquidity providers.</li>
</ul>

<h3 style="font-size: 1.2rem; margin-top: 1rem;">Business Incubation</h3>
<p style="margin: 0.5rem 0">Profit Allocation: 20% of profits from incubated businesses directed to buy back and burn LETH.</p>

<h3 style="font-size: 1.2rem; margin-top: 1rem;">Community and Education</h3>
<ul style="margin-left: 1.5rem; list-style-type: disc;">
    <li>Tutorials: For using USD stablecoin accounts with yield, strategic investing with efficient DCA, and participating in community events.</li>
    <li>Global DeFi Education: Through the LiberEther Academy the leader, Neriel, will conduct DeFi courses around the globe as well as virtually to teach people how to engage in safe DeFi practices and to spread awareness about Ethereum, Libertarianism, and, of course, LiberEther itself.</li>
    <li>Top 13 Incentive: The top 13 LETH holders will gain free access to all LiberEther Academy digital and in-person courses, including the special program to become a Defi professor.</li>
</ul>

<h3 style="font-size: 1.2rem; margin-top: 1rem;">Additional Information on Team</h3>
<h4 style="font-size: 1.1rem; margin-top: 0.8rem;">Leadership Loans and Team Structure:</h4>

<p style="margin: 0.5rem 0">In addition to project creation and management, Neriel supervises the Ne group - a dedicated marketing and social media team consisting of 7 members: Madara, Tenten, Bidu, Cindy, and Lala, Mr. Oakley responsible for managing all project-related social media and marketing initiatives and also Sennin our lead developer who is an honor member, receiving 4000 LETH tokens and enjoying the same privileges as the top 5 LETH holders. All Ne group members are incentivized with a deferred compensation, which will only be distributed at the end of a 2-year term on January 1, 2027. The  6 members of the Marketing/Social Media each receive 2000 LETH, while the honor member developer receives 4000 LETH with the same conditions.</p> 

<p style="margin: 0.5rem 0">The project leader, Neriel, has the right to a 10% LTV USD loan with his LETH holdings as collateral at a 0% interest rate up to 20% of the WarChest (treasury). This loan system is designed to maintain project independence by eliminating the need for venture capital funding and preventing sell pressure from LETH tokens.</p>

<p style="margin: 0.5rem 0">Creation of the LLC: At the project's 2nd anniversary, during the week-long camp event, starting on 1st september 2025, an LLC will be established with 20% of the WarChest. Ownership in this LLC will be based on the amount of LETH held by eligible participants, specifically the top 5 holders + honour member and the top 13 participants who is contributing with at least 50% of their LETH to liquidity pools on Uniswap V4 with RETH 50/50. These participants will also have their travel and accommodation expenses covered for the camp.</p>

<p style="margin: 0.5rem 0">Annual Distribution from the WarChest: Following the creation of the LLC, 20% of the WarChest (treasury) will be allocated every year, just like the initial LLC ownership. This allocation is intended for eligible members to invest in businesses that the project fostered.</p>

<p style="margin: 0.5rem 0">Note on OTC Trading: Encourage OTC trades with LETH between the top 13 members, even with locked tokens, by transferring ownership in an off-chain ledger to avoid significant market movements.</p>

<h3 style="font-size: 1.2rem; margin-top: 1rem;">Conclusion</h3>
<p style="margin: 0.5rem 0">The LETH Project is not just a cryptocurrency but a movement towards a self-governing, economically empowered community, demonstrating the practical application of libertarian principles in the digital age.</p>

<h3 style="font-size: 1.2rem; margin-top: 1rem;">Additional Note on Fund Utilization</h3>
<p style="margin: 0.5rem 0">Future funds raised with the project's remaining LETH tokens will be split with 20% going to the WarChest and 80% to add liquidity on Uniswap.</p>

<h3 style="font-size: 1.2rem; margin-top: 1rem;">Acknowledgements</h3>
<p style="margin: 0.5rem 0">We thank the Ethereum community, DeFi pioneers, and all supporters for their belief in a decentralized, libertarian-driven economic system.</p>

<h3 style="font-size: 1.2rem; margin-top: 1rem;">Core Values</h3>
<p style="margin: 0.5rem 0">Ethics: Promoting libertarian principles, self-governance, and financial freedom through technology.</p>

<p style="margin: 1rem 0; font-style: italic;">Note: This document is for informational purposes and not financial advice!</p>
</div>
        </div>
    </div>
`;
        
        document.body.insertAdjacentHTML('beforeend', modalHTML);
    });
    
    function openWhitepaper() {
        document.getElementById('whitepaper-modal').style.display = 'block';
    }
    
    function closeWhitepaper() {
        document.getElementById('whitepaper-modal').style.display = 'none';
    }
    
    // Close modal when clicking outside
    document.addEventListener('click', function(event) {
        const modal = document.getElementById('whitepaper-modal');
        if (event.target === modal) {
            closeWhitepaper();
        }
    });
    document.getElementById('addToken').onclick = async () => {
    try {
        if (typeof window.ethereum === 'undefined') {
            alert('Please install MetaMask first!');
            return;
        }

        await window.ethereum.request({
    method: 'wallet_watchAsset',
    params: {
        type: 'ERC20',
        options: {
            address: '0xf7acec1b4580f436866f96fe9eba6059039ea6f7',
            symbol: 'LETH',
            decimals: 18,
        }
    }
});
    } catch (error) {
        console.error(error);
        alert('Error adding token to MetaMask');
    }
};
    </script>
<!-- Bottom Navigation Bar -->
<nav class="fixed bottom-0 left-0 w-full bg-black bg-opacity-50 backdrop-blur-md z-50 p-2 flex justify-between items-center">
    <div id="google_translate_element" class="ml-4"></div>
    <div class="flex-1 flex justify-center">
        <div id="social-buttons"></div>
    </div>
    <div class="flex-1"></div>
</nav>

<!-- Logo Container -->
<div class="fixed bottom-0 right-0 z-50 p-2 flex items-center h-[64px] md:h-[72px]">
    <img src="https://s3.gifyu.com/images/bSLSb.png" alt="Built on Ethereum" class="h-6 md:h-10 w-auto object-contain">
</div>
<script>
    // Function to clear all ATH data from localStorage
function clearATHCache() {
    localStorage.removeItem('LETH_ath');
    localStorage.removeItem('ath_version');
}

// Clear the cache first
clearATHCache();

// Set initial ATH values
// Set initial ATH values
let ath = {
    price: 0.50,  // Your ATH price
    date: new Date("2024-01-31T12:00:00"), // Add time to ensure consistent date handling
    version: Date.now()
};

// Save initial values to localStorage
localStorage.setItem('LETH_ath', JSON.stringify(ath));

// Function to manually update ATH
function updateATHManually(newPrice, dateString = null) {
    try {
        // Convert price to number and validate
        const price = Number(newPrice);
        if (isNaN(price) || price <= 0) {
            console.error('Invalid price. Please provide a valid positive number.');
            return;
        }

        // Set date (use provided date or current date)
        const date = dateString ? new Date(dateString) : new Date();
        
        // Clear old data
        clearATHCache();
        
        // Update ATH with new version
        ath = {
            price: price,
            date: date,
            version: Date.now()
        };
        
        // Save new values
        localStorage.setItem('LETH_ath', JSON.stringify(ath));
        
        // Force update display
        updateATHDisplay();
        
        console.log('ATH updated successfully:', { price: ath.price, date: ath.date });
    } catch (error) {
        console.error('Error updating ATH:', error);
    }
}

// Function to update ATH display
// Function to update ATH display
function updateATHDisplay() {
    const athPriceEl = document.getElementById('athPrice');
    const athDateEl = document.getElementById('athDate');
    if (athPriceEl) {
        athPriceEl.textContent = `$${ath.price.toFixed(2)}`;
    }
    if (athDateEl) {
        // Format date as MM/DD/YYYY
        const d = new Date(ath.date);
        const month = d.getMonth() + 1;
        const day = d.getDate();
        const year = d.getFullYear();
        athDateEl.textContent = `(${month}/${day}/${year})`;
    }
}

// Initialize ATH on page load
document.addEventListener('DOMContentLoaded', function() {
    clearATHCache(); // Clear any old data
    updateATHManually(ath.price, ath.date); // Set new values
});

// Modify updatePriceAndATH function
async function updatePriceAndATH() {
    try {
        const currentPrice = priceData.currentPrice;
        
        // Update current price display
        const tokenPriceEl = document.getElementById('tokenPrice');
        if (tokenPriceEl) {
            tokenPriceEl.textContent = `$${currentPrice.toFixed(2)}`;
        }
        
        // Always use the manual ATH values
        updateATHDisplay();
        
        // Calculate and update price change
        const initialPrice = 0.10;
        const priceChange = ((currentPrice - initialPrice) / initialPrice) * 100;
        const priceChangeEl = document.getElementById('priceChange');
        if (priceChangeEl) {
            priceChangeEl.textContent = `${priceChange > 0 ? '+' : ''}${priceChange.toFixed(1)}% (Since Launch)`;
            priceChangeEl.className = `performance ${priceChange >= 0 ? 'positive' : 'negative'}`;
        }
    } catch (error) {
        console.error('Error updating price:', error);
    }
}

// Initialize ATH on page load
document.addEventListener('DOMContentLoaded', function() {
    // Force update ATH display on load
    updateATHManually(ath.price, ath.date);
});
    
    async function updatePriceAndATH() {
    try {
        // Use price from config instead of fetching
        const currentPrice = priceData.currentPrice;
        
        // Update current price
        const tokenPriceEl = document.getElementById('tokenPrice');
        if (tokenPriceEl) {
            tokenPriceEl.textContent = `$${currentPrice.toFixed(2)}`;
        }
        
        // Check and update ATH
        if (currentPrice > ath.price) {
            ath.price = currentPrice;
            ath.date = new Date();
            
            // Save to localStorage
            localStorage.setItem('LETH_ath', JSON.stringify(ath));
        }
        
        // Update ATH display
        const athPriceEl = document.getElementById('athPrice');
        const athDateEl = document.getElementById('athDate');
        if (athPriceEl) {
            athPriceEl.textContent = `$${ath.price.toFixed(2)}`;
        }
        if (athDateEl && ath.date) {
            athDateEl.textContent = `(${new Date(ath.date).toLocaleDateString()})`;
        }
        
        // Calculate and update price change
        const initialPrice = 0.10;
        const priceChange = ((currentPrice - initialPrice) / initialPrice) * 100;
        const priceChangeEl = document.getElementById('priceChange');
        if (priceChangeEl) {
            priceChangeEl.textContent = `${priceChange > 0 ? '+' : ''}${priceChange.toFixed(1)}% (Since Launch)`;
            priceChangeEl.className = `performance ${priceChange >= 0 ? 'positive' : 'negative'}`;
        }
    } catch (error) {
        console.error('Error updating price:', error);
    }
}
    
    // Load saved ATH from localStorage
    const savedATH = localStorage.getItem('LETH_ath');
    if (savedATH) {
        ath = JSON.parse(savedATH);
    }
    
    // Initial update
    updatePriceAndATH();
    
    // Update every 30 seconds
    setInterval(updatePriceAndATH, 30000);
    </script>
<!-- Replace the existing script with this -->
<div id="tutorialModal" class="fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 p-4" style="display: none;">
    <div class="relative bg-[#1e1e1e] rounded-lg p-4 max-w-2xl w-full">
        <button
            onclick="closeTutorialModal()"
            class="absolute top-2 right-2 text-white hover:text-gray-300 text-2xl font-bold w-8 h-8 flex items-center justify-center rounded-full hover:bg-[#2a2a2a] transition-colors"
        >
            Ã—
        </button>
        <div class="flex justify-center">
            <img 
                src="https://s13.gifyu.com/images/b2RJZ.gif" 
                alt="LETH Tutorial"
                class="rounded-lg max-w-full h-auto"
            />
        </div>
    </div>
</div>
<script>
    function openTutorialModal() {
        document.getElementById('tutorialModal').style.display = 'flex';
    }
    
    function closeTutorialModal() {
        document.getElementById('tutorialModal').style.display = 'none';
    }
    
    // Close modal when clicking outside
    document.getElementById('tutorialModal').addEventListener('click', function(event) {
        if (event.target === this) {
            closeTutorialModal();
        }
    });
    </script>
    <script>
        // Add this countdown code
        // Add this countdown code
function updateCountdown() {
    // Create target date (September 1st of the current year or next year if we're past Sept 1)
    const now = new Date();
    const currentYear = now.getFullYear();
    let targetYear = currentYear;
    
    // If we're already past September 1st of this year, target next year
    if (now.getMonth() > 7 || (now.getMonth() === 7 && now.getDate() >= 1)) {
        targetYear = currentYear + 1;
    }
    
    const targetDate = new Date(targetYear, 8, 1); // Month is 0-based, so 8 = September
    
    function updateTimer() {
        const now = new Date().getTime();
        const timeLeft = targetDate.getTime() - now;
        
        // Calculate days, hours, minutes, seconds
        const days = Math.floor(timeLeft / (1000 * 60 * 60 * 24));
        const hours = Math.floor((timeLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
        
        // Add leading zeros
        const displayDays = days < 10 ? "0" + days : days;
        const displayHours = hours < 10 ? "0" + hours : hours;
        const displayMinutes = minutes < 10 ? "0" + minutes : minutes;
        const displaySeconds = seconds < 10 ? "0" + seconds : seconds;
        
        // Update both countdown displays
        const countdownText = `${displayDays}d ${displayHours}h ${displayMinutes}m ${displaySeconds}s`;
        
        const countdownElement = document.getElementById('countdown');
        const countdownMobileElement = document.getElementById('countdown-mobile');
        
        if (countdownElement) {
            countdownElement.innerHTML = countdownText;
        }
        if (countdownMobileElement) {
            countdownMobileElement.innerHTML = countdownText;
        }
    }
    
    // Update immediately then every second
    updateTimer();
    setInterval(updateTimer, 1000);
}
        
        // Start countdown when page loads
        document.addEventListener('DOMContentLoaded', function() {
            updateCountdown();
        });
        </script>
        <script>
            // Ultimate notranslate protection script
            document.addEventListener('DOMContentLoaded', function() {
                <script>
// Fix Google Translate functionality while hiding top bar
document.addEventListener('DOMContentLoaded', function() {
  // Function to fix Google Translate
  const fixGoogleTranslate = function() {
    // Hide the top bar but keep functionality
    const bannerFrame = document.querySelector('.goog-te-banner-frame');
    if (bannerFrame) {
      bannerFrame.style.display = 'none';
      bannerFrame.style.visibility = 'hidden';
      bannerFrame.style.height = '0';
    }
    
    // Fix body positioning
    if (document.body.style.top) {
      document.body.style.top = '0';
    }
    
    // Make sure the dropdown is clickable
    const combo = document.querySelector('.goog-te-combo');
    if (combo) {
      combo.style.pointerEvents = 'auto';
      combo.style.zIndex = '1002';
    }
  };
  
  // Run the fix multiple times to ensure it works
  fixGoogleTranslate();
  setTimeout(fixGoogleTranslate, 1000);
  setTimeout(fixGoogleTranslate, 2000);
  
  // Also run when window loads
  window.addEventListener('load', fixGoogleTranslate);
});
</script>
<script src="milei-chat.js"></script>
<script>
// Function to set up Uniswap iframe with proper communication
function setupUniswapIntegration() {
    // Find elements
    const connectWalletButton = document.getElementById('connectWallet');
    const uniswapIframe = document.querySelector('.uniswap-iframe');
    
    if (!uniswapIframe || !connectWalletButton) {
        console.warn('Uniswap iframe or connect button not found');
        return;
    }
    
    // Add load event listener to iframe
    uniswapIframe.addEventListener('load', function() {
        console.log('Uniswap iframe loaded');
        
        // If we already have a connected wallet, send the connection info
        if (window.web3Security && window.web3Security.connectedAddress) {
            setTimeout(() => {
                window.web3Security.postMessageToUniswap();
            }, 1000); // Small delay to ensure iframe is fully loaded
        }
    });
    
    // Listen for messages from the iframe
    window.addEventListener('message', function(event) {
        // Verify message origin (you may want to restrict this to Uniswap's domain)
        // if (event.origin !== 'https://app.uniswap.org') return;
        
        // Handle wallet connection request from iframe
        if (event.data && event.data.type === 'CONNECT_WALLET_REQUEST') {
            console.log('Received wallet connection request from Uniswap');
            connectWalletButton.click(); // Trigger your existing wallet connect flow
        }
    });
    
    // Modify the Web3Security class to include iframe communication
    if (window.Web3Security) {
        // Update the connectWallet method to include iframe notification
        const originalConnectWallet = Web3Security.prototype.connectWallet;
        Web3Security.prototype.connectWallet = async function() {
            try {
                const result = await originalConnectWallet.apply(this, arguments);
                // Add post message step
                setTimeout(() => {
                    this.postMessageToUniswap();
                }, 500); // Small delay to ensure everything is ready
                return result;
            } catch (error) {
                console.error('Error in enhanced connectWallet:', error);
                throw error;
            }
        };
    } else {
        console.warn('Web3Security class not found, cannot enhance wallet connection');
    }
}

// Initialize when the page has fully loaded
document.addEventListener('DOMContentLoaded', setupUniswapIntegration);

// Also try to initialize when window is fully loaded (additional safety)
window.addEventListener('load', setupUniswapIntegration);
</script>
<script>
// Mobile-specific handling for Uniswap iframe connection
document.addEventListener('DOMContentLoaded', function() {
    // Get the connect wallet button and Uniswap iframe
    const connectButton = document.getElementById('connectWallet');
    const uniswapIframe = document.querySelector('.uniswap-iframe');
    
    if (!connectButton || !uniswapIframe) return;
    
    // When the connect button is clicked
    connectButton.addEventListener('click', function() {
        // Wait a bit for wallet to connect then send multiple connection messages to iframe
        setTimeout(function() {
            if (window.ethereum && window.ethereum.selectedAddress) {
                // Send wallet connection to Uniswap iframe
                uniswapIframe.contentWindow.postMessage({
                    type: 'CONNECT_WALLET',
                    address: window.ethereum.selectedAddress,
                    chainId: window.ethereum.chainId ? parseInt(window.ethereum.chainId) : 42161,
                    isConnected: true
                }, '*');
                
                console.log('Mobile wallet connection message sent to Uniswap');
            }
        }, 2000);
    });
});
</script>
</body>
</html>